#!/bin/bash

shred_file () 
{
    local file="${1}"
    if [[ -d ${file} ]]; then
        for item in $(ls -A ${file}); do
            shred_file ${file}/${item}
        done
        rmdir ${file}
    else
        /usr/bin/shred -vxzfun 35 ${file}
    fi
}

echo "You are about to delete the following: " ${@}
echo "Please confirm by typing '${@}' again (w/o quotes)"
read INPUT
while [[ ${INPUT} != ${@} ]] ; do
	echo "Please confirm by typing '${@}' again (w/o quotes)"
	read INPUT
done
echo "Please confirm by typing 'confirm' (w/o quotes)"
read INPUT
while [[ ${INPUT} != "confirm" ]] ; do
	if [[ ${INPUT} == "abort" ]] ; then
		exit 1
	fi
	echo "Please confirm by typing 'confirm' again (w/o quotes)"
	echo "You can abort by typing 'abort' (w/o quotes)"
	read INPUT
done
echo "Are you sure you wish to continue?"
read INPUT
while [[ ${INPUT} != "yes" ]] ; do
	if [[ ${INPUT} == "no" ]] ; then
		exit 1
	fi
	echo "Please confirm by typing 'yes' again (w/o quotes)"
	read INPUT
done
for item in ${@}; do
    shred_file "${item}"
done
